% Created 2015-07-20 月 14:37
\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{fixltx2e}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{float}
\usepackage{wrapfig}
\usepackage{soul}
\usepackage{textcomp}
\usepackage{marvosym}
\usepackage{wasysym}
\usepackage{latexsym}
\usepackage{amssymb}
\usepackage{hyperref}
\tolerance=1000
\providecommand{\alert}[1]{\textbf{#1}}

\title{vpc}
\author{}
\date{\today}
\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={Emacs Org-mode version 7.8.11}}

\begin{document}

\maketitle

\setcounter{tocdepth}{3}
\tableofcontents
\vspace*{1cm}
\section{VPCメモ}
\label{sec-1}
\subsection{VPCとは}
\label{sec-1-1}

\begin{itemize}
\item (最後の締め）VPCでネットワーク空間を作り、インターネットにサービスを提供する必要があるサーバはPublic側に配置し、それに対してしっかり保護すべきサーバはプライベート側に配置していただければAWSに作ったシステムをセキュアに保護することができる。
\end{itemize}
\subsection{VPCの全体構成図}
\label{sec-1-2}

\begin{enumerate}
\item 一番外側がAWS
\item その内側にVPC
\item VPCの中にはサブネットを作ることができる
\begin{itemize}
\item 左側がパブリックサブネット
\item 右側がプライベートサブネット
\begin{itemize}
\item プライベートサブネットのインスタンスがインターネットからパッチをダウンロードしたい場合、行うことができない
\begin{itemize}
\item その場合はパブリックサブネット側にNATインスタンスを置くことで行える
\item NATインスタンスは単一障害点になりがち
\item その場合はNATインスタンスのホットスタンバイとコールドスタンバイがある
\begin{itemize}
\item ホットスタンバイはNATインスタンス2台+インターナルELB
\item コールドスタンバイはNATインスタンスのAMIを作成して障害が発生したときは復元
\end{itemize}
\end{itemize}
\end{itemize}
\end{itemize}
\item 次にVPCにゲートウェイをアタッチ
\begin{itemize}
\item ゲートウェイにはIGWとVGWがある
\begin{itemize}
\item IGWはインターネットゲートウェイ
\item VGWはプライベートゲートウェイ
\begin{itemize}
\item それぞれアイコンだと単一のように見えるが、単一障害点やネットワークのトラフィックのボトルネックにならないようにAWSの方で構築・運用管理されている
\end{itemize}
\end{itemize}
\end{itemize}
\item 次がルートテーブルを作成してサブネットにアタッチ
\begin{itemize}
\item ルートテーブルはルーティングテーブル。サブネット内のすべてのインスタンスに適用される。
\item どの宛先ネットワークにパケットを送信するときに、どのルータにとりあえずパケットを転送すべきかを登録する
\begin{itemize}
\item その情報のことを経路情報と言う
\item デフォルトで経路情報は1つ登録されており、VPC内のインスタンスとは通信可能になっている
\end{itemize}
\item パブリックサブネットとプライベートサブネットの違いはルートテーブルのデフォルトゲートウエイにIGWが登録されているかされていないか
\begin{itemize}
\item 登録されているのがパブリックサブネット
\item 登録されていないのがプライベートサブネット
\item プライベートサブネットからインターネットにアクセスする場合はルートテーブルにNATインスタンスをデフォルトゲートウェイに登録すること
\end{itemize}
\item また、インターネットからプライベートサブネットのインスタンスにログインしてメンテナンスしたい場合は、パブリックサブネットに踏み台サーバを置き、踏み台サーバにまずログインしてそこからプライベートサブネット側のホストにログインする。
\begin{itemize}
\item 踏み台サーバは常時起動している必要はないため、必要なときに起動するという形でよい
\end{itemize}
\end{itemize}
\item 特に言い忘れないようにすること
\begin{itemize}
\item ルートテーブルにはデフォルトでVPC内のインスタンスと通信できるように経路情報が登録されている。
\begin{itemize}
\item 登録されている経路情報は「VPCのネットワークアドレス    local」
\end{itemize}
\item NATインスタンスを配置すると、NATインスタンスが単一障害点になりがち
\begin{itemize}
\item ホットスタンバイ構成なら「Internal ELB + NATインスタンスを2台」
\item コールドスタンバイ構成ならNATインスタンスのAMIから復元
\end{itemize}
\item NATインスタンスを配置して、それをプライベートサブネットのデフォルトゲートウェイにするとインターネットと通信可能に
\end{itemize}
\end{enumerate}
\subsection{VPC関連の用語1}
\label{sec-1-3}
\subsection{VPC関連の用語2}
\label{sec-1-4}
\subsection{VPCの作成}
\label{sec-1-5}

  -作成の流れ
\begin{enumerate}
\item VPCの作成
\item サブネットの作成
\item IGWまたはVGWを作成し、VPCにアタッチ
\item ルートテーブルを作成し、サブネットにアタッチ
\item VPCの作成
\begin{itemize}
\item 2013年5月以降にAWSアカウントを取った方はDefault VPC環境となっていて、デフォルトで１つVPCが作成され、パブリックサブネットもすべてのAZに対して作られている
\item VPCのネットワークアドレスに172.31.0.0/16が設定されている
\item 通常はデフォルトで作成されているVPCをそのまま使うことはない。新しくネットワークをどう作るか設計して、独自に作成する
\item VPCの作成方法は2つ
\begin{enumerate}
\item ウイザードから作成
\begin{itemize}
\item 簡単にVPCを作成可能
\end{itemize}
\item VPCの要素を1つ1つ作成
\begin{itemize}
\item 一つ一つ設定をしっかり行いながら作成したい場合
\end{itemize}
\end{enumerate}
\end{itemize}
\end{enumerate}
\section{}

\end{document}
