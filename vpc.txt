* VPCメモ
** VPCとは
  - (最後の締め）VPCでネットワーク空間を作り、インターネットにサービスを提供する必要があるサーバはPublic側に配置し、それに対してしっかり保護すべきサーバはプライベート側に配置していただければAWSに作ったシステムをセキュアに保護することができる。
** VPCの全体構成図
  - 一番外側がAWS
  - その内側にVPC
  - VPCの中にはサブネットを作ることができる
   - 左側がパブリックサブネット
   - 右側がプライベートサブネット
    - プライベートサブネットのインスタンスがインターネットからパッチをダウンロードしたい場合、行うことができない
     - その場合はパブリックサブネット側にNATインスタンスを置くことで行える
     - NATインスタンスは単一障害点になりがち
     - その場合はNATインスタンスのホットスタンバイとコールドスタンバイがある
      - ホットスタンバイはNATインスタンス2台+インターナルELB
      - コールドスタンバイはNATインスタンスのAMIを作成して障害が発生したときは復元
  - 次にVPCにゲートウェイをアタッチ
   - ゲートウェイにはIGWとVGWがある
    - IGWはインターネットゲートウェイ
    - VGWはプライベートゲートウェイ
     - それぞれアイコンだと単一のように見えるが、単一障害点やネットワークのトラフィックのボトルネックにならないようにAWSの方で構築・運用管理されている
  - 次がルートテーブルを作成してサブネットにアタッチ
   - ルートテーブルはルーティングテーブル
   - どの宛先ネットワークにパケットを送信するときに、どのルータにとりあえずパケットを転送すべきかを登録する
    - その情報のことを経路情報と言う
    - デフォルトで経路情報は1つ登録されており、VPC内のインスタンスとは通信可能になっている
   - パブリックサブネットとプライベートサブネットの違いはルートテーブルのデフォルトゲートウエイにIGWが登録されているかされていないか
    - 登録されているのがパブリックサブネット
    - 登録されていないのがプライベートサブネット
    - プライベートサブネットからインターネットにアクセスする場合はルートテーブルにNATインスタンスをデフォルトゲートウェイに登録すること
  
  - 特に言い忘れないようにすること
   - ルートテーブルにはデフォルトでVPC内のインスタンスと通信できるように経路情報が登録されている。
    - 登録されている経路情報は「VPCのネットワークアドレス    local」
   - NATインスタンスを配置すると、NATインスタンスが単一障害点になりがち
    - ホットスタンバイ構成なら「Internal ELB + NATインスタンスを2台」
    - コールドスタンバイ構成ならNATインスタンスのAMIから復元
   - NATインスタンスを配置して、それをプライベートサブネットのデフォルトゲートウェイにするとインターネットと通信可能に

** VPC関連の用語1
** VPC関連の用語2

** VPCの作成
  1. VPCの作成
  2. サブネットの作成
  3. IGWまたはVGWを作成し、VPCにアタッチ
  4. ルートテーブルを作成し、サブネットにアタッチ
** VPCの作成
*** 2013年5月以降にAWSアカウントを取った方はDefault VPC環境となっていて、デフォルトで１つVPCが作成され、パブリックサブネットもすべてのAZに対して作られている
**** VPCのネットワークアドレスに172.31.0.0/16が設定されている 
*** 通常はデフォルトで作成されているVPCをそのまま使うことはない。新しくネットワークをどう作るか設計して、独自に作成する
*** VPCの作成方法は2つ
    1. ウイザードから作成
    2. VPCの要素を1つ1つ作成
*** 
